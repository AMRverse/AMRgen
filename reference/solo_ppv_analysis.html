<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform Solo PPV Analysis for AMR Markers — solo_ppv_analysis • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Solo PPV Analysis for AMR Markers — solo_ppv_analysis"><meta name="description" content="This function performs a Positive Predictive Value (PPV) analysis for AMR markers
associated with a given antibiotic and drug class. The function calculates the PPV
for solo markers (those with only one genetic marker relevant to the drug class)
and visualizes the results using various plots. It returns a list containing summary
statistics for each solo marker, and associated plots showing the breakdown of
resistance phenotypes, and PPV (with 95% confidence interval) for each marker."><meta property="og:description" content="This function performs a Positive Predictive Value (PPV) analysis for AMR markers
associated with a given antibiotic and drug class. The function calculates the PPV
for solo markers (those with only one genetic marker relevant to the drug class)
and visualizes the results using various plots. It returns a list containing summary
statistics for each solo marker, and associated plots showing the breakdown of
resistance phenotypes, and PPV (with 95% confidence interval) for each marker."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/interpretAMR/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform Solo PPV Analysis for AMR Markers</h1>
      <small class="dont-index">Source: <a href="https://github.com/interpretAMR/AMRgen/blob/main/R/solo_ppv.R" class="external-link"><code>R/solo_ppv.R</code></a></small>
      <div class="d-none name"><code>solo_ppv_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs a Positive Predictive Value (PPV) analysis for AMR markers
associated with a given antibiotic and drug class. The function calculates the PPV
for solo markers (those with only one genetic marker relevant to the drug class)
and visualizes the results using various plots. It returns a list containing summary
statistics for each solo marker, and associated plots showing the breakdown of
resistance phenotypes, and PPV (with 95% confidence interval) for each marker.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">solo_ppv_analysis</span><span class="op">(</span></span>
<span>  <span class="va">geno_table</span>,</span>
<span>  <span class="va">pheno_table</span>,</span>
<span>  <span class="va">antibiotic</span>,</span>
<span>  <span class="va">drug_class_list</span>,</span>
<span>  geno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pheno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sir_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep_assay_values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="st">"IndianRed"</span>, I <span class="op">=</span> <span class="st">"orange"</span>, S <span class="op">=</span> <span class="st">"lightgrey"</span>, NWT <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span>,</span>
<span>  pd <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-geno-table">geno_table<a class="anchor" aria-label="anchor" href="#arg-geno-table"></a></dt>
<dd><p>A data frame containing genotype data, including at least one column labeled
<code>drug_class</code> for drug class information and one column for sample identifiers (specified via
<code>geno_sample_col</code> otherwise it is assumed the first column contains identifiers).</p></dd>


<dt id="arg-pheno-table">pheno_table<a class="anchor" aria-label="anchor" href="#arg-pheno-table"></a></dt>
<dd><p>A data frame containing phenotype data, which must include a column <code>drug_agent</code>
(with the antibiotic information) and a column with the resistance interpretation (S/I/R, colname
specified via <code>sir_col</code>).</p></dd>


<dt id="arg-antibiotic">antibiotic<a class="anchor" aria-label="anchor" href="#arg-antibiotic"></a></dt>
<dd><p>A character string specifying the antibiotic of interest to filter phenotype data.
The value must match one of the entries in the <code>drug_agent</code> column of <code>pheno_table</code>.</p></dd>


<dt id="arg-drug-class-list">drug_class_list<a class="anchor" aria-label="anchor" href="#arg-drug-class-list"></a></dt>
<dd><p>A character vector of drug classes to filter genotype data for markers
related to the specified antibiotic. Markers in <code>geno_table</code> will be filtered based on whether
their <code>drug_class</code> matches any value in this list.</p></dd>


<dt id="arg-geno-sample-col">geno_sample_col<a class="anchor" aria-label="anchor" href="#arg-geno-sample-col"></a></dt>
<dd><p>A character string (optional) specifying the column name in <code>geno_table</code>
containing sample identifiers. Defaults to <code>NULL</code>, in which case it is assumed the first column
contains identifiers.</p></dd>


<dt id="arg-pheno-sample-col">pheno_sample_col<a class="anchor" aria-label="anchor" href="#arg-pheno-sample-col"></a></dt>
<dd><p>A character string (optional) specifying the column name in <code>pheno_table</code>
containing sample identifiers. Defaults to <code>NULL</code>, in which case it is assumed the first column
contains identifiers.</p></dd>


<dt id="arg-sir-col">sir_col<a class="anchor" aria-label="anchor" href="#arg-sir-col"></a></dt>
<dd><p>A character string specifying the column name in <code>pheno_table</code> that contains
the resistance interpretation (SIR) data. The values should be interpretable as "R" (resistant),
"I" (intermediate), or "S" (susceptible).</p></dd>


<dt id="arg-plot-cols">plot_cols<a class="anchor" aria-label="anchor" href="#arg-plot-cols"></a></dt>
<dd><p>A named vector of colors for the plot. The names should be the phenotype categories
(e.g., "R", "I", "S", "NWT"), and the values should be valid color names or hexadecimal color codes.
Default colors are provided for resistant ("R"), intermediate ("I"), susceptible ("S"), and non-wild-type ("NWT").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following elements:</p><dl><dt>solo_stats</dt>
<dd><p>A dataframe summarizing the PPV for resistance (R vs S/I) and NWT (R/I vs S),
including the number of positive hits, sample size, PPV, and 95% confidence intervals for each marker.</p></dd>

<dt>combined_plot</dt>
<dd><p>A combined ggplot object showing the PPV plot for the solo markers, and a bar plot
for the phenotype distribution.</p></dd>

<dt>solo_binary</dt>
<dd><p>A dataframe with binary values indicating the presence or absence of the solo markers.</p></dd>

<dt>amr_binary</dt>
<dd><p>A dataframe with binary values for the AMR markers, based on the input genotype and phenotype data.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># import genotype data</span></span></span>
<span class="r-in"><span><span class="va">geno_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="import_amrfp.html">import_amrfp</a></span><span class="op">(</span><span class="va">ecoli_geno_raw</span>, <span class="st">"Name"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example phenotype data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ecoli_ast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">soloPPV_cipro</span> <span class="op">&lt;-</span> <span class="fu">solo_ppv_analysis</span><span class="op">(</span></span></span>
<span class="r-in"><span>  geno_table <span class="op">=</span> <span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  pheno_table <span class="op">=</span> <span class="va">ecoli_ast</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the results</span></span></span>
<span class="r-in"><span><span class="va">soloPPV_cipro</span><span class="op">$</span><span class="va">solo_stats</span></span></span>
<span class="r-in"><span><span class="va">soloPPV_cipro</span><span class="op">$</span><span class="va">combined_plot</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-2), brought by interpretAMR-AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

