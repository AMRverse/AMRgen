<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>amr_upset: Generate a series of plots for AMR gene and combination analysis — amr_upset • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="amr_upset: Generate a series of plots for AMR gene and combination analysis — amr_upset"><meta name="description" content="This function generates a set of visualizations to analyze AMR gene combinations, MIC values, and gene prevalence
from a given binary matrix. It creates several plots, including MIC distributions, a bar plot for
the percentage of strains per combination, a dot plot for gene combinations in strains, and a plot for gene prevalence."><meta property="og:description" content="This function generates a set of visualizations to analyze AMR gene combinations, MIC values, and gene prevalence
from a given binary matrix. It creates several plots, including MIC distributions, a bar plot for
the percentage of strains per combination, a dot plot for gene combinations in strains, and a plot for gene prevalence."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/interpretAMR/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>amr_upset: Generate a series of plots for AMR gene and combination analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/interpretAMR/AMRgen/blob/main/R/amr_upset.R" class="external-link"><code>R/amr_upset.R</code></a></small>
      <div class="d-none name"><code>amr_upset.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a set of visualizations to analyze AMR gene combinations, MIC values, and gene prevalence
from a given binary matrix. It creates several plots, including MIC distributions, a bar plot for
the percentage of strains per combination, a dot plot for gene combinations in strains, and a plot for gene prevalence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">amr_upset</span><span class="op">(</span><span class="va">binmat_orig</span>, min_set_size <span class="op">=</span> <span class="fl">2</span>, order <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-binmat-orig">binmat_orig<a class="anchor" aria-label="anchor" href="#arg-binmat-orig"></a></dt>
<dd><p>A data frame containing the original binary matrix output from the <code>get_binary_matrix</code> function,
with columns representing genes, resistance, MIC values, and metadata such as microorganism and antibiotic
information. This needs to be updated / standardised in future versions of AMRgen.</p></dd>


<dt id="arg-min-set-size">min_set_size<a class="anchor" aria-label="anchor" href="#arg-min-set-size"></a></dt>
<dd><p>An integer specifying the minimum size for a gene set to be included in the analysis and plots.
Default is 2. Only genes with at least this number of occurrences are included in the plots.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>A character string indicating the order of the combinations on the x-axis. Options are:
- "": Default (decreasing frequency of combinations),
- "genes": Order by the number of genes in each combination,
- "mic": Order by the median MIC of each combination. Default is decreasing frequency.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A grid of plots displaying:
- A plot for MIC values across combinations (g1),
- A bar plot showing the percentage of strains in each combination (g2),
- A dot plot of gene combinations in strains (g3),
- A gene prevalence plot displaying the set size for each gene (g4).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function processes the provided binary matrix (<code>binmat_orig</code>), which is expected to contain data on gene
combinations found in the strain, MIC for that strain (e.g., resistance or susceptibility) and
corresponding MIC values for different genes.
The function also includes an analysis of gene prevalence and an ordering option for visualizing combinations
in different ways.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example usage</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example input data from `get_binary_matrix` function, has mic, R/NWT, and gene lists</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_binary_matrix.html">get_binary_matrix</a></span><span class="op">(</span><span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_table</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span>,</span></span>
<span class="r-in"><span>  keep_assay_values <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  keep_assay_values_from <span class="op">=</span> <span class="st">"mic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">amr_upset</span><span class="op">(</span><span class="va">data</span>, min_set_size <span class="op">=</span> <span class="fl">3</span>, order <span class="op">=</span> <span class="st">"mic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-2), brought by interpretAMR-AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

