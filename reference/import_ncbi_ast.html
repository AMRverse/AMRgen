<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import and Process AST Data from an NCBI File — import_ncbi_ast • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import and Process AST Data from an NCBI File — import_ncbi_ast"><meta name="description" content="This function imports an antibiotic susceptibility testing (AST) dataset, processes the data, and optionally interprets the results based on MIC or disk diffusion data. It assumes that the input file is a tab-delimited text file (e.g., TSV) and parses relevant columns (antibiotic names, species names, MIC or disk data) into suitable classes using the AMR package. It optionally can use the AMR package to determine susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible."><meta property="og:description" content="This function imports an antibiotic susceptibility testing (AST) dataset, processes the data, and optionally interprets the results based on MIC or disk diffusion data. It assumes that the input file is a tab-delimited text file (e.g., TSV) and parses relevant columns (antibiotic names, species names, MIC or disk data) into suitable classes using the AMR package. It optionally can use the AMR package to determine susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible."><meta property="og:image" content="https://amrverse.github.io/AMRgen/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/AnalysingGenoPhenoData.html"><span class="fa fa-book"></span> Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/amrverse/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import and Process AST Data from an NCBI File</h1>
      <small class="dont-index">Source: <a href="https://github.com/amrverse/AMRgen/blob/main/R/import_pheno.R" class="external-link"><code>R/import_pheno.R</code></a></small>
      <div class="d-none name"><code>import_ncbi_ast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function imports an antibiotic susceptibility testing (AST) dataset, processes the data, and optionally interprets the results based on MIC or disk diffusion data. It assumes that the input file is a tab-delimited text file (e.g., TSV) and parses relevant columns (antibiotic names, species names, MIC or disk data) into suitable classes using the AMR package. It optionally can use the AMR package to determine susceptibility phenotype (SIR) based on EUCAST or CLSI guidelines (human breakpoints and/or ECOFF). If expected columns are not found warnings will be given, and interpretation may not be possible.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">import_ncbi_ast</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  sample_col <span class="op">=</span> <span class="st">"#BioSample"</span>,</span>
<span>  interpret <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  ecoff <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  default_guideline <span class="op">=</span> <span class="st">"EUCAST"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>A string representing a dataframe, or a path to a tab-delimited file, containing the AST data in NCBI antibiogram format. These files can be downloaded from NCBI AST browser, e.g. https://www.ncbi.nlm.nih.gov/pathogens/ast#Pseudomonas%20aeruginosa</p></dd>


<dt id="arg-sample-col">sample_col<a class="anchor" aria-label="anchor" href="#arg-sample-col"></a></dt>
<dd><p>A string indicating the name of the column with sample identifiers. If <code>NULL</code>, assume this is '#BioSample'.</p></dd>


<dt id="arg-interpret">interpret<a class="anchor" aria-label="anchor" href="#arg-interpret"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the susceptibility phenotype (SIR) for each row based on the MIC or disk diffusion values, against human breakpoints from either EUCAST or CLSI testing standard (as indicated in the <code>Testing standard</code> column of the input file, if blank the value of the <code>default_guideline</code> parameter will be used by default). If <code>FALSE</code>, no interpretation is performed.</p></dd>


<dt id="arg-ecoff">ecoff<a class="anchor" aria-label="anchor" href="#arg-ecoff"></a></dt>
<dd><p>A logical value (default is FALSE). If <code>TRUE</code>, the function will interpret the wildtype vs nonwildtype status for each row based on the MIC or disk diffusion values, against epidemiological cut-off (ECOFF) values. These will be reported in a new column <code>ecoff</code>, coded as 'NWT' (nonwildtype) or 'WT' (wildtype). If <code>FALSE</code>, no ECOFF interpretation is performed.</p></dd>


<dt id="arg-default-guideline">default_guideline<a class="anchor" aria-label="anchor" href="#arg-default-guideline"></a></dt>
<dd><p>A string (default is "EUCAST"). Default guideline to use for interpretation via <code>as.sir</code>. Allowed values are 'EUCAST' or 'CLSI'. If the input file contains a column <code>Testing standard</code>, or if <code>interpret</code> or <code>ecoff</code> are set to <code>TRUE</code>, a new column <code>guideline</code> will be created to use in the interpretation step. Values are populated from those in <code>Testing standard</code>, however rows with missing/NA values or non-allowed values will be coerced to the value specified by <code>default_guideline</code>. If there is no <code>Testing standard</code> column, all rows will be interpreted using the <code>default_guideline</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the processed AST data, including additional columns:</p><ul><li><p><code>id</code>: The biological sample identifier (renamed from <code>#BioSample</code> or specified column).</p></li>
<li><p><code>spp_pheno</code>: The species phenotype, formatted using the <code>as.mo</code> function.</p></li>
<li><p><code>drug_agent</code>: The antibiotic used in the test, formatted using the <code>as.ab</code> function.</p></li>
<li><p><code>mic</code>: The minimum inhibitory concentration (MIC) value, formatted using the <code>as.mic</code> function.</p></li>
<li><p><code>disk</code>: The disk diffusion measurement (in mm), formatted using the <code>as.disk</code> function.</p></li>
<li><p><code>guideline</code>: The guideline used for interpretation (either EUCAST or CLSI; taken from input column otherwise forced to parameter <code>default_guideline</code>).</p></li>
<li><p><code>pheno</code>: The phenotype interpreted against the specified breakpoint standard (as S/I/R), based on the MIC or disk diffusion data.</p></li>
<li><p><code>ecoff</code>: The wildtype/nonwildtype status interpreted against the ECOFF (as WT/NWT), based on the MIC or disk diffusion data.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># small example E. coli AST data from NCBI</span></span></span>
<span class="r-in"><span><span class="va">ecoli_ast_raw</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import without re-interpreting resistance</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">import_ncbi_ast</span><span class="op">(</span><span class="va">ecoli_ast_raw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import and re-interpret resistance (S/I/R) and ECOFF (WT/NWT) using AMR package</span></span></span>
<span class="r-in"><span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu">import_ncbi_ast</span><span class="op">(</span><span class="va">ecoli_ast_raw</span>, interpret <span class="op">=</span> <span class="cn">TRUE</span>, ecoff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pheno</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-2), brought by amrverse-AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

