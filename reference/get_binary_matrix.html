<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get Binary Matrix of Genotype and Phenotype Data — get_binary_matrix • AMRgen</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Binary Matrix of Genotype and Phenotype Data — get_binary_matrix"><meta name="description" content="This function generates a binary matrix representing the resistance (R vs S/I) and nonwildtype (R/I vs S)
status for a given antibiotic, and presence or absence of genetic markers related to one or more specified
drug classes. It takes as input separate tables for genotype and phenotype data, matches these according
to a common identifier (either specified by column names or assuming the first column contains the ID),
and filters the data according to the specified antibiotic and drug class criteria before creating a binary
matrix. Suitable input files can be generated using import_ncbi_ast to import phenotype data from NCBI,
and parse_amrfp to import genotype data from AMRfinderPlus."><meta property="og:description" content="This function generates a binary matrix representing the resistance (R vs S/I) and nonwildtype (R/I vs S)
status for a given antibiotic, and presence or absence of genetic markers related to one or more specified
drug classes. It takes as input separate tables for genotype and phenotype data, matches these according
to a common identifier (either specified by column names or assuming the first column contains the ID),
and filters the data according to the specified antibiotic and drug class criteria before creating a binary
matrix. Suitable input files can be generated using import_ncbi_ast to import phenotype data from NCBI,
and parse_amrfp to import genotype data from AMRfinderPlus."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AMRgen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-book-open"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/AnalysingGenoPhenoData.html"><span class="fa fa-book"></span> Vignettes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/interpretAMR/AMRgen"><span class="fa fab fa-github"></span> Source Code</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get Binary Matrix of Genotype and Phenotype Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/interpretAMR/AMRgen/blob/main/R/get_binary_matrix.R" class="external-link"><code>R/get_binary_matrix.R</code></a></small>
      <div class="d-none name"><code>get_binary_matrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a binary matrix representing the resistance (R vs S/I) and nonwildtype (R/I vs S)
status for a given antibiotic, and presence or absence of genetic markers related to one or more specified
drug classes. It takes as input separate tables for genotype and phenotype data, matches these according
to a common identifier (either specified by column names or assuming the first column contains the ID),
and filters the data according to the specified antibiotic and drug class criteria before creating a binary
matrix. Suitable input files can be generated using <code>import_ncbi_ast</code> to import phenotype data from NCBI,
and <code>parse_amrfp</code> to import genotype data from AMRfinderPlus.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_binary_matrix</span><span class="op">(</span></span>
<span>  <span class="va">geno_table</span>,</span>
<span>  <span class="va">pheno_table</span>,</span>
<span>  <span class="va">antibiotic</span>,</span>
<span>  <span class="va">drug_class_list</span>,</span>
<span>  keep_SIR <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  keep_assay_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_assay_values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mic"</span>, <span class="st">"disk"</span><span class="op">)</span>,</span>
<span>  geno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pheno_sample_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sir_col <span class="op">=</span> <span class="st">"pheno"</span>,</span>
<span>  ecoff_col <span class="op">=</span> <span class="st">"ecoff"</span>,</span>
<span>  most_resistant <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-geno-table">geno_table<a class="anchor" aria-label="anchor" href="#arg-geno-table"></a></dt>
<dd><p>A data frame containing genotype data, including at least one column labeled
<code>drug_class</code> for drug class information and one column for sample identifiers (specified via
<code>geno_sample_col</code>, otherwise it is assumed the first column contains identifiers).</p></dd>


<dt id="arg-pheno-table">pheno_table<a class="anchor" aria-label="anchor" href="#arg-pheno-table"></a></dt>
<dd><p>A data frame containing phenotype data, which must include a column <code>drug_agent</code>
(with the antibiotic information), a column with the resistance interpretation (S/I/R, specified via <code>sir_col</code>),
and optionally a column with the ECOFF interpretation (WT/NWT, specified via <code>ecoff_col</code>).</p></dd>


<dt id="arg-antibiotic">antibiotic<a class="anchor" aria-label="anchor" href="#arg-antibiotic"></a></dt>
<dd><p>A character string specifying the antibiotic of interest to filter phenotype data.
The value must match one of the entries in the <code>drug_agent</code> column of <code>pheno_table</code>.</p></dd>


<dt id="arg-drug-class-list">drug_class_list<a class="anchor" aria-label="anchor" href="#arg-drug-class-list"></a></dt>
<dd><p>A character vector of drug classes to filter genotype data for markers
related to the specified antibiotic. Markers in <code>geno_table</code> will be filtered based on whether
their <code>drug_class</code> matches any value in this list.</p></dd>


<dt id="arg-keep-sir">keep_SIR<a class="anchor" aria-label="anchor" href="#arg-keep-sir"></a></dt>
<dd><p>A logical indicating whether to retain the full S/I/R phenotype column in the output.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-keep-assay-values">keep_assay_values<a class="anchor" aria-label="anchor" href="#arg-keep-assay-values"></a></dt>
<dd><p>A logical indicating whether to include columns with the raw phenotype assay data.
Assumes there are columns labelled "mic" and "disk"; these will be added to the output table if present.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-keep-assay-values-from">keep_assay_values_from<a class="anchor" aria-label="anchor" href="#arg-keep-assay-values-from"></a></dt>
<dd><p>A character vector specifying which assay values (e.g., <code>"mic"</code>, <code>"disk"</code>)
to retain if <code>keep_assay_values</code> is <code>TRUE</code>. Defaults to <code>c("mic", "disk")</code>.</p></dd>


<dt id="arg-geno-sample-col">geno_sample_col<a class="anchor" aria-label="anchor" href="#arg-geno-sample-col"></a></dt>
<dd><p>A character string (optional) specifying the column name in <code>geno_table</code>
containing sample identifiers. Defaults to <code>NULL</code>, in which case it is assumed the first column
contains identifiers.</p></dd>


<dt id="arg-pheno-sample-col">pheno_sample_col<a class="anchor" aria-label="anchor" href="#arg-pheno-sample-col"></a></dt>
<dd><p>A character string (optional) specifying the column name in <code>pheno_table</code>
containing sample identifiers. Defaults to <code>NULL</code>, in which case it is assumed the first column
contains identifiers.</p></dd>


<dt id="arg-sir-col">sir_col<a class="anchor" aria-label="anchor" href="#arg-sir-col"></a></dt>
<dd><p>A character string specifying the column name in <code>pheno_table</code> that contains
the resistance interpretation (SIR) data. The values should be interpretable as "R" (resistant),
"I" (intermediate), or "S" (susceptible).</p></dd>


<dt id="arg-ecoff-col">ecoff_col<a class="anchor" aria-label="anchor" href="#arg-ecoff-col"></a></dt>
<dd><p>A character string specifying the column name in <code>pheno_table</code> that contains
the ECOFF interpretation of phenotype. The values should be interpretable as "WT" (wildtype)
or "NWT" (nonwildtype).</p></dd>


<dt id="arg-most-resistant">most_resistant<a class="anchor" aria-label="anchor" href="#arg-most-resistant"></a></dt>
<dd><p>A logical indicating whether, when multiple phenotype entries are present for the same
sample and drug, whether to keep the most resistant (otherwise the least resistant is kept). Default TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame where each row represents a sample, and each column represents a genetic marker
related to the specified antibiotic's drug class. The binary values in the matrix indicate the presence
(<code>1</code>) or absence (<code>0</code>) of each marker for each sample, along with resistance status columns for the
specified antibiotic (<code>R</code> for resistant defined from the <code>sir_col</code> (1=R, 0=I/S); <code>NWT</code> for
nonwildtype, defined by the <code>ecoff_col</code> if provided (1=NWT, 0=WT), and otherwise defined from the
<code>sir_col</code> (1=I/R, 0=S)).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs several steps:</p><ul><li><p>Verifies that the <code>pheno_table</code> contains a <code>drug_agent</code> column and converts it to class <code>ab</code> if necessary.</p></li>
<li><p>Filters the <code>pheno_table</code> to retain data related to the specified antibiotic.</p></li>
<li><p>Checks that the <code>geno_table</code> contains markers associated with the specified drug class(es).</p></li>
<li><p>Matches sample identifiers between <code>geno_table</code> and <code>pheno_table</code>.</p></li>
<li><p>Extracts and transforms the phenotype data into a binary format indicating resistance and NWT status.</p></li>
<li><p>Constructs a binary matrix for genotype data, with each column representing a genetic marker.</p></li>
<li><p>Returns a single matrix with sample identifiers plus binary variables for each phenotype and genetic marker.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>compare_geno_pheno_id</code>, <code>as.ab</code>, <code>as.sir</code>, <code>ab_name</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example usage</span></span></span>
<span class="r-in"><span><span class="va">geno_table</span> <span class="op">&lt;-</span> <span class="fu">parse_amrfp</span><span class="op">(</span><span class="st">"testdata/Ecoli_AMRfinderplus_n50.tsv"</span>, <span class="st">"Name"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pheno_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="import_ncbi_ast.html">import_ncbi_ast</a></span><span class="op">(</span><span class="st">"testdata/Ecoli_AST_NCBI_n50.tsv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binary R/NWT phenotypes only</span></span></span>
<span class="r-in"><span><span class="fu">get_binary_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_table</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return AST assay phenotype values (default = MIC, disk)</span></span></span>
<span class="r-in"><span><span class="fu">get_binary_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_table</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span>,</span></span>
<span class="r-in"><span>  keep_assay_values <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return MIC phenotype values only</span></span></span>
<span class="r-in"><span><span class="fu">get_binary_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_table</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span>,</span></span>
<span class="r-in"><span>  keep_assay_values <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  keep_assay_values_from <span class="op">=</span> <span class="st">"mic"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">get_binary_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">geno_table</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_table</span>,</span></span>
<span class="r-in"><span>  antibiotic <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,</span></span>
<span class="r-in"><span>  drug_class_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Quinolones"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sir_col <span class="op">=</span> <span class="st">"Resistance phenotype"</span>,</span></span>
<span class="r-in"><span>  keep_assay_values <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  keep_assay_values_from <span class="op">=</span> <span class="st">"MIC (mg/L)"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Free and Open Source (GPL-2), brought by interpretAMR-AMRgen Development Team</p>
</div>

<div class="pkgdown-footer-right">
  <p>Our goal is to develop interpretive standards for AMR genotypes, akin to the interpretive standards developed by EUCAST and CLSI for antimicrobial susceptibility phenotyping.</p>
</div>

    </footer></div>





  </body></html>

